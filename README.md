# Hyper-V-support-for-OpenWrt-Barrier-Breaker

English:

Hyper-V support for OpenWrt Barrier Breaker X86 or X86_64

Hyper-V support for OpenWrt Barrier Breaker X86 or X86_64 were noticeably missing.  

There are previous patches for old Kernels but never maintained or merged into the Barrier Breaker.

Here's my take on adding the Hyper-V patch for the Barrier Breaker (kernel 3.10) based on Ning Ye's source code, https://patchwork.ozlabs.org/patch/431583/. Thanks for Ning Ye!

No new sub targets or profiles are created, as long as the target is x86 or x86_64. The generic works well or any other profiles.  

Also added a new VHD target image menu. But please use the latest stable Linux (Ubuntu or Centos) qemu-img to convert the .img file into vhd/vhdx format.

The vhd/vhdx file generated by the OpenWrt buildroot would NOT work due to the buildroot uses obsolete qemu-img.

This patch supports the Hyper-V standard virtual NIC, as well as the legacy NIC.

To apply the patch:

(1) Download the patch file and copy it to the buildroot folder.

(2) Apply with command 'git apply --verbose bb-hyper-v.patch'.

====================================================================================================
Chinese:

让OpenWrt Barrier Breaker X86或X86_64支持Hyper-V虚拟机

很明显，OpenWrt Barrier Breaker X86或X86_64是不支持Hyper-V虚拟机的。

之前有些补丁支持旧的核心，但这些补丁已经无人维护，也未合并到Barrier Breaker。

这是我在Ning Ye源代码的基础上制作的Barrier Breaker（内核3.10）的Hyper-V的补丁，Ning Ye的源代码请参见（https://patchwork.ozlabs.org/patch/431583/
）。感谢Ning Ye！

由于目标配置是x86或x86_64，没有新的子目标或配置文件被创建。generic配置文件或任何其他文件可以很好的工作。

补丁还增加了一个生成VHD目标镜像菜单。但请使用新版本、稳定的Linux（Ubuntu或者Centos的）的qemu-img，将.img文件转换为vhd/ vhdx格式。

由OpenWrt的buildroot生成的hd/vhdx文件将无法使用，由于buildroot使用旧版本的qemu-img。

这个补丁支持Hyper-V的标准虚拟网卡，也支持legacy模式的网卡。

应用补丁：

(1)下载补丁文件并将其拷贝到buildroot文件夹。

(2)运行命令应用补丁，“git apply --verbose bb-hyper-v.patch”
